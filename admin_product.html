<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Admin Dashboard • Product</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

  <style type="text/tailwindcss">
    :root{
      --primary:#06B6D4; --primary-hover:#0891B2;
      --bg-deep:#061222; --bg-bluegray:#0D3042;
      --heading:#1F2937; --body:#6B7280;
      --input-bg:#F9FAFB; --input-border:#D1D5DB;
    }
    html,body{height:100%}
    body{
      @apply text-[15px] antialiased;
      color:var(--body);
      background:
        radial-gradient(1200px 800px at 20% 0%, rgba(6,182,212,.08), transparent 60%),
        radial-gradient(900px 700px at 80% 100%, rgba(8,145,178,.08), transparent 60%),
        linear-gradient(180deg, var(--bg-deep) 0%, var(--bg-bluegray) 100%);
      background-attachment:fixed;
    }
    .bg-waves::before{
      content:""; position:absolute; inset:0; pointer-events:none; opacity:.35;
      background-image:url('data:image/svg+xml;utf8,\
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 600" preserveAspectRatio="none">\
        <defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1">\
          <stop stop-color="%2306B6D4" stop-opacity="0.25"/><stop offset="1" stop-color="%230D3042" stop-opacity="0.1"/>\
        </linearGradient></defs>\
        <path d="M0,120 C240,200 480,40 720,100 C960,160 1200,40 1440,120 L1440,0 L0,0 Z" fill="url(%23g)"/>\
        <path d="M0,480 C220,420 520,560 760,500 C1000,440 1210,560 1440,500 L1440,600 L0,600 Z" fill="url(%23g)"/>\
      </svg>');
      background-size:cover; background-position:center; filter:blur(2px);
    }

    .card{@apply bg-white rounded-2xl shadow-xl shadow-black/10}
    .heading{color:var(--heading)}
    .input{background:var(--input-bg); border:1px solid var(--input-border); @apply rounded-xl px-3 py-2 outline-none transition}
    .input:focus{border-color:var(--primary); box-shadow:0 0 0 3px rgba(6,182,212,.25)}
    .btn-primary{background:var(--primary); color:#fff; @apply inline-flex items-center gap-2 rounded-xl px-4 py-2 font-medium transition}
    .btn-primary:hover{background:var(--primary-hover)}
    .btn-ghost{@apply rounded-xl px-4 py-2 font-medium text-white border border-white/30 hover:bg-white/10 transition}
    .btn-danger{@apply rounded-xl px-4 py-2 font-medium text-white bg-rose-600 hover:bg-rose-700}
    .link{color:var(--primary)} .link:hover{text-decoration:underline}

    .topbar{ @apply sticky top-0 z-30 backdrop-blur bg-white/5; }
    .topbar-border{ box-shadow: inset 0 -1px 0 0 rgba(255,255,255,.12); }
    .nav-link{ @apply text-white/90 px-3 py-2 rounded-xl transition font-medium; }
    .nav-link:hover{ @apply text-white; background: rgba(255,255,255,.08); }
    .nav-active-pill{ @apply bg-white text-[#0F172A] rounded-xl; box-shadow: 0 1px 0 rgba(0,0,0,.04), 0 6px 20px -12px rgba(0,0,0,.35); }
    .brand-home{ @apply h-10 w-10 rounded-2xl grid place-items-center; background: var(--primary); box-shadow: inset 0 1px 0 rgba(255,255,255,.25), 0 8px 20px -10px rgba(6,182,212,.8); }
    .search-glass{ @apply rounded-2xl border px-4 py-2 pl-10 text-white/95 min-w-[280px]; background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04)); border-color: rgba(255,255,255,.25); }
    .search-glass::placeholder{ color: rgba(255,255,255,.75); }
    .search-glass:focus{ outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(6,182,212,.25); }
    .user-pill{ @apply rounded-2xl border px-3 py-1.5 flex items-center gap-2 text-white/90 relative; background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04)); border-color: rgba(255,255,255,.25); }
    .user-avatar{ @apply h-8 w-8 rounded-full grid place-items-center text-white font-semibold; background: var(--primary); box-shadow: inset 0 1px 0 rgba(255,255,255,.35); }
    .dropdown{ @apply absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-xl shadow-black/10 p-4 z-40; }
    .drop-row{@apply flex items-center gap-3 text-sm text-[#374151];}
    .drop-link{@apply text-[#0F172A] hover:bg-gray-100 rounded-lg px-3 py-2 w-full text-left;}

    .grid-row{@apply grid grid-cols-[1fr_1fr_120px_40px] gap-2 items-center}
    .divider{ @apply h-px bg-gray-200 my-2 }
    .badge{ @apply inline-flex items-center rounded-full text-xs px-2 py-0.5 bg-gray-100 text-gray-700 }

    /* modal hidden by default, visible when .open is added */
    .modal{ @apply fixed inset-0 bg-black/50 z-50 hidden; }
    .modal.open{ @apply grid place-items-center; }
    .modal-card{ @apply bg-white rounded-2xl p-6 w-[min(94vw,560px)] shadow-xl }
  </style>
</head>

<body class="relative">
  <div class="bg-waves absolute inset-0 -z-10"></div>

  <div class="min-h-full">
    <!-- HEADER -->
    <div class="topbar topbar-border">
      <div class="mx-auto px-4 md:px-8">
        <div class="h-16 flex items-center gap-4">
          <div class="brand-home">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M3 10.5L12 3l9 7.5V21a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1v-10.5Z"/></svg>
          </div>

          <nav id="topNav" class="flex items-center gap-1">
            <a href="admin_dashboard.html" class="nav-link" data-route="dashboard">Dashboard</a>
            <a href="admin_rental.html" class="nav-link" data-route="rental">Rental</a>
            <a href="admin_order.html" class="nav-link" data-route="order">Order</a>
            <a href="admin_product.html" class="nav-link nav-active-pill" data-route="products">Products</a>
            <a href="admin_reporting.html" class="nav-link" data-route="reporting">Reporting</a>
            <a href="admin_setting.html" class="nav-link" data-route="setting">Setting</a>
          </nav>

          <div class="ml-auto flex items-center gap-3">
            <div class="relative">
              <input id="globalSearch" class="search-glass" type="search" placeholder="Search products…" />
              <svg class="absolute left-3 top-1/2 -translate-y-1/2" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-opacity=".85" stroke-width="2">
                <circle cx="11" cy="11" r="7"/><path d="M20 20l-3.5-3.5"/>
              </svg>
            </div>

            <div class="relative">
              <button id="profileBtn" type="button" class="user-pill" aria-haspopup="true" aria-expanded="false">
                <span class="user-avatar">A</span><span>Adam</span>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
              </button>

              <div id="profileMenu" class="dropdown hidden">
                <div class="drop-row">
                  <div class="h-10 w-10 rounded-full bg-[var(--primary)] grid place-items-center text-white font-semibold">A</div>
                  <div><div class="font-semibold">Adam Carter</div><div class="text-xs text-gray-500">Super Admin</div></div>
                </div>
                <div class="mt-2 text-sm text-gray-600">adam@rentalshop.io</div>
                <hr class="my-3">
                <button class="drop-link" type="button">Profile</button>
                <button class="drop-link" type="button">Security</button>
                <hr class="my-3">
                <button class="drop-link" id="signOut" type="button">Sign out</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Toolbar (Product pill removed) -->
        <div class="flex items-center gap-3 pb-4">
          <button id="newBtn" type="button" class="btn-primary">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"/></svg>
            Create
          </button>

          <!-- Removed the middle 'Product' pill here -->

          <button id="stockBtn" type="button" class="btn-danger">Update stock</button>
          <span class="ml-auto text-white/70 text-sm">Items: <span id="countBadge" class="badge">0</span></span>
        </div>
      </div>
    </div>

    <!-- CONTENT -->
    <main class="px-4 md:px-8 pb-16">
      <header class="mt-2 mb-2"><h1 class="heading text-2xl md:text-3xl font-bold">Product</h1></header>

      <section class="card p-0 overflow-hidden">
        <div class="grid lg:grid-cols-2">
          <!-- LEFT -->
          <div class="p-6 border-r border-gray-100">
            <h2 class="heading text-lg font-semibold mb-4">General Product info</h2>
            <div class="grid md:grid-cols-2 gap-4">
              <div><label class="block text-sm text-gray-600 mb-1">Product Name</label><input id="pName" class="input w-full" type="text" placeholder="e.g., Professional Camera Kit"/></div>
              <div><label class="block text-sm text-gray-600 mb-1">SKU</label><input id="pSku" class="input w-full" type="text" placeholder="e.g., CAM-PR-001"/></div>
              <div><label class="block text-sm text-gray-600 mb-1">Category</label><input id="pCategory" class="input w-full" type="text" placeholder="Cameras"/></div>
              <div><label class="block text-sm text-gray-600 mb-1">Brand</label><input id="pBrand" class="input w-full" type="text" placeholder="Canon / Sony"/></div>
              <div><label class="block text-sm text-gray-600 mb-1">Base Price (Rs)</label><input id="pBase" class="input w-full" type="number" min="0" step="0.01" placeholder="0.00"/></div>
              <div><label class="block text-sm text-gray-600 mb-1">Tax %</label><input id="pTax" class="input w-full" type="number" min="0" step="0.01" placeholder="18"/></div>
            </div>
            <div class="mt-4"><label class="block text-sm text-gray-600 mb-1">Description</label><textarea id="pDesc" class="input w-full h-28" placeholder="Short description…"></textarea></div>
            <div class="mt-4 grid md:grid-cols-[120px_1fr] gap-4 items-start">
              <div><img id="pPhotoPreview" class="h-28 w-28 rounded-xl object-cover bg-gray-100" alt="Photo"/></div>
              <div><label class="block text-sm text-gray-600 mb-1">Photos</label><input id="pPhoto" type="file" accept="image/*" class="input w-full"/><p class="text-xs text-gray-500 mt-1">First image becomes the thumbnail.</p></div>
            </div>
            <div class="mt-4 grid md:grid-cols-3 gap-4">
              <div><label class="block text-sm text-gray-600 mb-1">Status</label><select id="pStatus" class="input w-full"><option>Active</option><option>Draft</option><option>Archived</option></select></div>
              <div><label class="block text-sm text-gray-600 mb-1">Quantity in stock</label><input id="pQty" class="input w-full" type="number" min="0" step="1" placeholder="0"/></div>
              <div><label class="block text-sm text-gray-600 mb-1">Location</label><input id="pLoc" class="input w-full" type="text" placeholder="Main Warehouse"/></div>
            </div>
          </div>

          <!-- RIGHT -->
          <div class="p-6">
            <h2 class="heading text-lg font-semibold">Rental Pricing</h2>
            <div class="mt-3 text-sm text-gray-600">Add pricing rows for each rental period:</div>
            <div id="pricingRows" class="mt-3 space-y-2"></div>
            <button id="addRow" type="button" class="mt-2 btn-primary">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"/></svg> Add Period
            </button>

            <div class="divider"></div>
            <h3 class="heading font-semibold">Rental Reservations charges</h3>
            <div class="grid md:grid-cols-2 gap-4 mt-3">
              <div><label class="block text-sm text-gray-600 mb-1">Extra Hour (Rs)</label><input id="chHour" class="input w-full" type="number" min="0" step="0.01" placeholder="0.00"/></div>
              <div><label class="block text-sm text-gray-600 mb-1">Extra Day (Rs)</label><input id="chDay" class="input w-full" type="number" min="0" step="0.01" placeholder="0.00"/></div>
            </div>
          </div>
        </div>
      </section>

      <div class="mt-6 flex flex-wrap gap-3">
        <button id="saveBtn" type="button" class="btn-primary">Save Product</button>
        <button id="cancelBtn" type="button" class="btn-primary">Cancel</button>
        <a class="link" href="#list">Jump to list</a>
      </div>

      <section id="list" class="card p-5 mt-8 overflow-x-auto">
        <div class="flex items-center justify-between">
          <h3 class="heading font-semibold">Existing Products</h3>
          <span class="text-sm text-gray-500">Click a row to load for editing.</span>
        </div>
        <table class="min-w-[840px] w-full border-separate border-spacing-y-2 mt-3">
          <thead>
            <tr class="text-left text-xs uppercase tracking-wide text-gray-500">
              <th class="px-3 py-2">#</th><th class="px-3 py-2">Name</th><th class="px-3 py-2">SKU</th>
              <th class="px-3 py-2">Category</th><th class="px-3 py-2">Brand</th>
              <th class="px-3 py-2 text-right">Base Price</th><th class="px-3 py-2 text-right">Qty</th>
              <th class="px-3 py-2">Status</th><th class="px-3 py-2">Location</th><th class="px-3 py-2">Actions</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </section>
    </main>
  </div>

  <!-- Modal -->
  <div id="stockModal" class="modal" aria-modal="true" role="dialog">
    <div class="modal-card">
      <h3 class="heading text-lg font-semibold">Update stock</h3>
      <div class="grid md:grid-cols-3 gap-4 mt-4">
        <div><label class="block text-sm text-gray-600 mb-1">Adjust (+/-)</label><input id="mQty" class="input w-full" type="number" step="1" value="1"/></div>
        <div><label class="block text-sm text-gray-600 mb-1">Location</label><input id="mLoc" class="input w-full" type="text" placeholder="Main Warehouse"/></div>
        <div><label class="block text-sm text-gray-600 mb-1">Reason</label><select id="mReason" class="input w-full"><option>Purchase</option><option>Return</option><option>Damage</option><option>Manual Adjust</option></select></div>
      </div>
      <div class="mt-5 flex justify-end gap-2">
        <button id="mCancel" type="button" class="btn-ghost">Cancel</button>
        <button id="mApply" type="button" class="btn-primary">Apply</button>
      </div>
    </div>
  </div>

  <div id="toast" class="fixed right-4 bottom-4 bg-[#0F172A] text-white rounded-xl px-4 py-2 shadow-xl hidden">Saved</div>

  <script>
    const $ = id => document.getElementById(id);
    const toast = (m)=>{ const t=$('toast'); t.textContent=m; t.classList.remove('hidden'); setTimeout(()=>t.classList.add('hidden'),1400); };
    const stateKey='rs_products_final_no_pill';

    // prevent "#" jumps
    document.getElementById('topNav').addEventListener('click', e=>{
      const a=e.target.closest('a'); if(!a) return; e.preventDefault();
      [...document.querySelectorAll('#topNav a')].forEach(x=>x.classList.remove('nav-active-pill'));
      a.classList.add('nav-active-pill');
    });

    // profile dropdown
    (function(){
      const btn=$('profileBtn'), menu=$('profileMenu');
      btn.addEventListener('click', e=>{ e.stopPropagation(); menu.classList.toggle('hidden'); });
      document.addEventListener('click', ()=>menu.classList.add('hidden'));
    })();

    let products = JSON.parse(localStorage.getItem(stateKey) || '[]');
    let currentId = null;

    function addPricingRow(row={period:'1 Day', pricelist:'Standard', price:''}){
      const wrap=$('pricingRows');
      const div=document.createElement('div');
      div.className='grid-row';
      div.innerHTML=`
        <input class="input" placeholder="Rental Period (e.g., 1 Day)" value="${row.period||''}">
        <input class="input" placeholder="Pricelist (e.g., Standard)" value="${row.pricelist||''}">
        <input class="input text-right" type="number" min="0" step="0.01" placeholder="0.00" value="${row.price||''}">
        <button class="btn-danger h-[42px]" type="button" title="Remove row">&times;</button>`;
      div.querySelector('button').addEventListener('click', ev=>{ ev.stopPropagation(); div.remove(); });
      wrap.appendChild(div);
    }
    $('addRow').addEventListener('click', ()=>addPricingRow());

    // modal
    const stockModal=$('stockModal');
    function openModal(){ stockModal.classList.add('open'); document.body.classList.add('overflow-hidden'); $('mLoc').value=$('pLoc').value||'Main Warehouse'; $('mQty').value=1; setTimeout(()=>$('mQty').focus(),0); }
    function closeModal(){ stockModal.classList.remove('open'); document.body.classList.remove('overflow-hidden'); }
    $('stockBtn').addEventListener('click', openModal);
    $('mCancel').addEventListener('click', closeModal);
    stockModal.addEventListener('click', e=>{ if(e.target===stockModal) closeModal(); });
    $('mApply').addEventListener('click', ()=>{
      const d=parseInt($('mQty').value||'0',10); if(!d){ alert('Enter a quantity to adjust.'); return; }
      $('pQty').value=String((parseInt($('pQty').value||'0',10))+d); $('pLoc').value=$('mLoc').value; closeModal(); toast('Stock updated');
    });

    // photo preview
    $('pPhoto').addEventListener('change', e=>{
      const f=e.target.files[0]; if(!f) return; const r=new FileReader(); r.onload=()=>{ $('pPhotoPreview').src=r.result; }; r.readAsDataURL(f);
    });

    function newProduct(){
      currentId=null;
      ['pName','pSku','pCategory','pBrand','pBase','pTax','pDesc','pQty','pLoc','chHour','chDay'].forEach(id=>$(id).value='');
      $('pStatus').value='Active'; $('pPhotoPreview').src=''; $('pricingRows').innerHTML='';
      addPricingRow({period:'1 Day',pricelist:'Standard',price:''}); addPricingRow({period:'1 Week',pricelist:'Standard',price:''});
    }
    $('newBtn').addEventListener('click', newProduct);
    $('cancelBtn').addEventListener('click', newProduct);

    function collectPricing(){
      return [...document.querySelectorAll('#pricingRows .grid-row')].map(r=>{
        const [period,pricelist,price]=[...r.querySelectorAll('input')].map(i=>i.value.trim());
        return {period,pricelist,price:Number(price||0)};
      }).filter(r=>r.period||r.pricelist||r.price);
    }

    function saveProduct(){
      const p={
        id: currentId || ('PRD-'+Date.now()),
        name:$('pName').value.trim(), sku:$('pSku').value.trim(), category:$('pCategory').value.trim(),
        brand:$('pBrand').value.trim(), base:Number($('pBase').value||0), tax:Number($('pTax').value||0),
        desc:$('pDesc').value.trim(), status:$('pStatus').value, qty:parseInt($('pQty').value||'0',10),
        loc:$('pLoc').value.trim(), photo:$('pPhotoPreview').src||'', pricing:collectPricing(),
        charges:{hour:Number($('chHour').value||0), day:Number($('chDay').value||0)}
      };
      if(!p.name){ alert('Product name is required.'); return; }
      const i=products.findIndex(x=>x.id===p.id); if(i>-1) products[i]=p; else products.unshift(p);
      localStorage.setItem(stateKey, JSON.stringify(products)); currentId=p.id; renderTable(); updateCount(); toast('Product saved');
    }
    $('saveBtn').addEventListener('click', saveProduct);

    function loadProduct(p){
      currentId=p.id;
      $('pName').value=p.name; $('pSku').value=p.sku; $('pCategory').value=p.category; $('pBrand').value=p.brand;
      $('pBase').value=p.base; $('pTax').value=p.tax; $('pDesc').value=p.desc; $('pStatus').value=p.status;
      $('pQty').value=p.qty; $('pLoc').value=p.loc; $('pPhotoPreview').src=p.photo||'';
      $('pricingRows').innerHTML=''; (p.pricing?.length? p.pricing:[{period:'1 Day',pricelist:'Standard',price:''}]).forEach(addPricingRow);
      $('chHour').value=p.charges?.hour||''; $('chDay').value=p.charges?.day||''; window.scrollTo({top:0,behavior:'smooth'});
    }

    function deleteProduct(id){
      if(!confirm('Delete this product?')) return;
      products=products.filter(p=>p.id!==id); localStorage.setItem(stateKey, JSON.stringify(products));
      renderTable(); updateCount(); toast('Product deleted'); if(currentId===id) newProduct();
    }

    function renderTable(filter=''){
      const tb=$('tbody'); tb.innerHTML='';
      const list = filter? products.filter(p=>(p.name+' '+p.sku+' '+p.category+' '+p.brand).toLowerCase().includes(filter.toLowerCase())) : products;
      list.forEach((p,i)=>{
        const tr=document.createElement('tr'); tr.className='bg-gray-50 hover:bg-gray-100';
        tr.innerHTML=`
          <td class="px-3 py-2">${i+1}</td>
          <td class="px-3 py-2"><div class="flex items-center gap-2"><img src="${p.photo||''}" class="h-8 w-8 rounded-lg bg-gray-200 object-cover" alt=""><span class="heading font-medium">${p.name}</span></div></td>
          <td class="px-3 py-2">${p.sku||'-'}</td><td class="px-3 py-2">${p.category||'-'}</td><td class="px-3 py-2">${p.brand||'-'}</td>
          <td class="px-3 py-2 text-right">₹ ${(p.base||0).toLocaleString('en-IN')}</td>
          <td class="px-3 py-2 text-right">${p.qty||0}</td><td class="px-3 py-2">${p.status}</td><td class="px-3 py-2">${p.loc||'-'}</td>
          <td class="px-3 py-2"><div class="flex gap-2">
            <button data-act="edit" type="button" class="btn-primary px-3 py-1.5 text-sm">Edit</button>
            <button data-act="del"  type="button" class="btn-danger px-3 py-1.5 text-sm">Delete</button>
          </div></td>`;
        tr.addEventListener('click', ()=>loadProduct(p));
        tr.querySelector('[data-act="edit"]').addEventListener('click', e=>{ e.stopPropagation(); loadProduct(p); });
        tr.querySelector('[data-act="del"]').addEventListener('click', e=>{ e.stopPropagation(); deleteProduct(p.id); });
        tb.appendChild(tr);
      });
    }

    $('globalSearch').addEventListener('input', e=>renderTable(e.target.value));
    function updateCount(){ $('countBadge').textContent=products.length; }

    if(products.length===0){
      products=[{id:'PRD-1001',name:'Professional Camera Kit',sku:'CAM-PR-001',category:'Cameras',brand:'Canon',base:150,tax:18,desc:'4K camera with 24-70mm lens.',status:'Active',qty:12,loc:'Main Warehouse',photo:'',pricing:[{period:'1 Day',pricelist:'Standard',price:150},{period:'1 Week',pricelist:'Standard',price:900}],charges:{hour:50,day:120}},
               {id:'PRD-1002',name:'LED Light Panel',sku:'LED-LGT-021',category:'Lighting',brand:'Aputure',base:45,tax:18,desc:'Bi-color LED panel with softbox.',status:'Active',qty:30,loc:'Aisle B',photo:'',pricing:[{period:'1 Day',pricelist:'Standard',price:45}],charges:{hour:15,day:35}}];
      localStorage.setItem(stateKey, JSON.stringify(products));
    }

    renderTable(); updateCount(); newProduct();
  </script>
</body>
</html>
