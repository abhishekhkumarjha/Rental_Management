<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RentalShop • Orders & Status</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<style type="text/tailwindcss">
  :root{
    --primary:#06B6D4; --primary-hover:#0891B2;
    --bg-deep:#061222; --bg-bluegray:#0D3042;
    --heading:#1F2937; --body:#6B7280;
    --input-bg:#F9FAFB; --input-border:#D1D5DB;
  }
  html,body{height:100%}
  body{
    @apply text-[15px] antialiased;
    color:var(--body);
    background:
      radial-gradient(1200px 800px at 20% 0%, rgba(6,182,212,.08), transparent 60%),
      radial-gradient(900px 700px at 80% 100%, rgba(8,145,178,.08), transparent 60%),
      linear-gradient(180deg, var(--bg-deep) 0%, var(--bg-bluegray) 100%);
    background-attachment:fixed;
  }
  .bg-waves::before{
    content:""; position:absolute; inset:0; pointer-events:none; opacity:.35;
    background-image:url('data:image/svg+xml;utf8,\
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 600" preserveAspectRatio="none">\
        <defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1">\
          <stop stop-color="%2306B6D4" stop-opacity="0.25"/><stop offset="1" stop-color="%230D3042" stop-opacity="0.1"/>\
        </linearGradient></defs>\
        <path d="M0,120 C240,200 480,40 720,100 C960,160 1200,40 1440,120 L1440,0 L0,0 Z" fill="url(%23g)"/>\
        <path d="M0,480 C220,420 520,560 760,500 C1000,440 1210,560 1440,500 L1440,600 L0,600 Z" fill="url(%23g)"/>\
      </svg>');
    background-size:cover; background-position:center; filter:blur(2px);
  }
  .card{@apply bg-white rounded-2xl shadow-xl shadow-black/10}
  .heading{color:var(--heading)}
  .input{background:var(--input-bg); border:1px solid var(--input-border); @apply rounded-xl px-3 py-2 outline-none transition}
  .input:focus{border-color:var(--primary); box-shadow:0 0 0 3px rgba(6,182,212,.25)}
  .btn-primary{background:var(--primary); color:#fff; @apply inline-flex items-center gap-2 rounded-xl px-4 py-2 font-medium transition}
  .btn-primary:hover{background:var(--primary-hover)}
  .btn-soft{@apply rounded-xl px-3 py-2 font-medium bg-gray-100 text-gray-800 hover:bg-gray-200}
  .topbar{@apply sticky top-0 z-30 backdrop-blur bg-white/5}
  .pill{@apply rounded-2xl border px-3 py-2 text-white/90 bg-white/10 border-white/20}
  .pill-active{@apply bg-white text-[#0F172A]}
  .brand-home{ @apply h-10 w-10 rounded-2xl grid place-items-center; background: var(--primary); box-shadow: inset 0 1px 0 rgba(255,255,255,.25), 0 8px 20px -10px rgba(6,182,212,.8); }
  .search-glass{ @apply rounded-2xl border px-4 py-2 pl-10 text-white/95 min-w-[260px]; background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04)); border-color: rgba(255,255,255,.25); }
  .search-glass::placeholder{ color: rgba(255,255,255,.75); }
  .badge{ @apply inline-flex items-center rounded-full text-xs px-2 py-0.5 bg-gray-100 text-gray-700 }
  .status-pill{ @apply px-2 py-0.5 rounded-full text-xs font-medium }
  .status-Pending{ @apply bg-yellow-100 text-yellow-800 }
  .status-Confirmed{ @apply bg-blue-100 text-blue-800 }
  .status-Out{ @apply bg-indigo-100 text-indigo-800 }
  .status-Delivered{ @apply bg-emerald-100 text-emerald-800 }
  .status-Cancelled{ @apply bg-rose-100 text-rose-800 }
  .drawer{ @apply fixed inset-y-0 right-0 w-full max-w-lg bg-white shadow-2xl z-50 translate-x-full transition-transform }
  .drawer.open{ @apply translate-x-0 }
</style>
</head>
<body>
<div class="bg-waves absolute inset-0 -z-10"></div>

<!-- HEADER -->
<header class="topbar">
  <div class="max-w-7xl mx-auto px-4 lg:px-6">
    <div class="h-16 grid grid-cols-[auto,1fr,auto] items-center gap-4">
      <div class="brand-home">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><path d="M3 10.5L12 3l9 7.5V21a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1v-10.5Z"/></svg>
      </div>

      <nav class="flex items-center gap-2">
        <a href="#" class="pill">Home</a>
        <a href="#" class="pill pill-active">Rental Shop</a>
        <a href="shop_wishlist.html" class="pill">Wishlist</a>
      </nav>

      <div class="flex items-center gap-3 justify-self-end">
        <div class="relative">
          <input class="search-glass" type="search" placeholder="Search products…">
          <svg class="absolute left-3 top-1/2 -translate-y-1/2" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><circle cx="11" cy="11" r="7"/><path d="M20 20l-3.5-3.5"/></svg>
        </div>
        <button id="cartBtn" class="relative rounded-full h-10 w-10 grid place-items-center bg-white/10 border border-white/20 text-white">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 12.39A2 2 0 0 0 9.62 15H19a2 2 0 0 0 2-1.59l1.38-7.41H6"/></svg>
          <span id="cartBadge" class="absolute -top-1 -right-1 text-xs bg-[var(--primary)] text-white rounded-full px-1.5 py-0.5">0</span>
        </button>
        <div class="relative">
          <button id="me" class="rounded-2xl border px-3 py-1.5 flex items-center gap-2 text-white/90 bg-white/10 border-white/25">
            <span class="h-8 w-8 rounded-full grid place-items-center bg-[var(--primary)] text-white font-semibold">A</span> Adam
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M6 9l6 6 6-6"/></svg>
          </button>
          <div id="meMenu" class="absolute right-0 mt-2 w-48 bg-white rounded-2xl shadow-xl shadow-black/10 overflow-hidden hidden z-20">
            <a class="block px-3 py-2 text-sm text-[#111827] hover:bg-gray-100" href="#">Profile</a>
            <a class="block px-3 py-2 text-sm text-[#111827] hover:bg-gray-100" href="#">Orders</a>
            <a class="block px-3 py-2 text-sm text-[#111827] hover:bg-gray-100" href="#">Sign out</a>
          </div>
        </div>
        <a class="btn-soft" href="#">Contact us</a>
      </div>
    </div>
  </div>
</header>

<!-- MAIN -->
<main class="max-w-7xl mx-auto px-4 lg:px-6 py-6">
  <header class="mb-4">
    <h1 class="heading text-2xl font-bold text-white">Your Orders</h1>
  </header>

  <!-- CURRENT ORDER -->
  <section class="card p-6">
    <div class="flex items-center justify-between">
      <div>
        <div class="text-sm text-gray-500">Current order</div>
        <h2 id="curId" class="heading font-semibold">—</h2>
      </div>
      <div class="text-right">
        <div class="text-sm text-gray-500">ETA</div>
        <div id="curEta" class="heading font-semibold">—</div>
      </div>
    </div>

    <div class="mt-4">
      <ol id="steps" class="grid grid-cols-4 gap-2 text-center">
        <!-- steps injected -->
      </ol>
      <div class="mt-3 h-2 rounded-full bg-gray-200 overflow-hidden">
        <div id="progress" class="h-full bg-[var(--primary)] w-0 transition-all"></div>
      </div>
    </div>

    <div id="curSummary" class="mt-4 text-gray-600">—</div>
  </section>

  <!-- HISTORY -->
  <section class="card p-6 mt-6">
    <div class="flex flex-wrap items-center gap-3">
      <div class="relative">
        <input id="search" class="input pl-10" placeholder="Search order id or product…">
        <svg class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="7"/><path d="M20 20l-3.5-3.5"/></svg>
      </div>
      <select id="filter" class="input">
        <option value="">All statuses</option>
        <option value="Pending">Pending</option>
        <option value="Confirmed">Confirmed</option>
        <option value="Out for delivery">Out for delivery</option>
        <option value="Delivered">Delivered</option>
        <option value="Cancelled">Cancelled</option>
      </select>
      <button id="clearFilters" class="btn-soft">Reset</button>
      <span class="ml-auto text-sm text-gray-500">Showing <span id="count">0</span> orders</span>
    </div>

    <div class="overflow-x-auto mt-4">
      <table class="min-w-[860px] w-full border-separate border-spacing-y-2">
        <thead>
          <tr class="text-left text-xs uppercase tracking-wide text-gray-500">
            <th class="px-3 py-2">Order ID</th>
            <th class="px-3 py-2">Date</th>
            <th class="px-3 py-2">Items</th>
            <th class="px-3 py-2 text-right">Total</th>
            <th class="px-3 py-2">Status</th>
            <th class="px-3 py-2">Action</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
  </section>
</main>

<!-- DETAILS DRAWER -->
<aside id="drawer" class="drawer">
  <div class="h-full grid grid-rows-[auto,1fr]">
    <div class="border-b p-4 flex items-center justify-between">
      <div>
        <div class="text-sm text-gray-500">Order</div>
        <div id="dId" class="heading font-semibold">—</div>
      </div>
      <button id="dClose" class="btn-soft">Close</button>
    </div>
    <div class="overflow-y-auto p-4">
      <div class="grid gap-3">
        <div>
          <div class="heading font-semibold mb-1">Items</div>
          <ul id="dItems" class="space-y-2"></ul>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <div class="heading font-semibold mb-1">Delivery address</div>
            <div id="dShip" class="text-gray-600 text-sm whitespace-pre-line">—</div>
          </div>
          <div>
            <div class="heading font-semibold mb-1">Invoice address</div>
            <div id="dBill" class="text-gray-600 text-sm whitespace-pre-line">—</div>
          </div>
        </div>
        <div>
          <div class="heading font-semibold mb-1">Charges</div>
          <div id="dCharges" class="text-gray-700 text-sm">—</div>
        </div>
        <div>
          <div class="heading font-semibold mb-1">Timeline</div>
          <ol id="dTimeline" class="relative border-l pl-4 space-y-2">
            <!-- items -->
          </ol>
        </div>
      </div>
    </div>
  </div>
</aside>

<script>
  // ---------- Helpers ----------
  const $=(s,r=document)=>r.querySelector(s);
  const $$=(s,r=document)=>[...r.querySelectorAll(s)];
  const fmt=n=>'₹ ' + (Number(n)||0).toLocaleString('en-IN',{maximumFractionDigits:2});
  const day=(d)=>new Date(d).toLocaleDateString('en-IN',{year:'numeric',month:'short',day:'numeric'});

  // Profile dropdown
  $('#me').addEventListener('click', e=>{ e.stopPropagation(); $('#meMenu').classList.toggle('hidden'); });
  document.addEventListener('click', ()=>$('#meMenu').classList.add('hidden'));

  // Cart badge
  const cartKey='rs_cart_count';
  $('#cartBadge').textContent = localStorage.getItem(cartKey) || '0';

  // ---------- Demo / persisted orders ----------
  const key='rs_orders';
  if(!localStorage.getItem(key)){
    const seed=[
      {
        id:'RS-240001', date:'2025-08-01T10:15:00Z',
        items:[
          {name:'Professional Camera Kit', qty:1, price:1500},
          {name:'LED Light Panel', qty:2, price:500}
        ],
        deliveryCharge:120, coupon:'SAVE10', taxRate:0.18,
        ship:'42, Park Lane\nBandra, Mumbai 400050', bill:'42, Park Lane\nBandra, Mumbai 400050',
        status:'Out for delivery', eta:'Today, 7:30 PM',
        timeline:[
          {t:'2025-08-01T10:30:00Z', label:'Order confirmed'},
          {t:'2025-08-01T12:00:00Z', label:'Packed at warehouse'},
          {t:'2025-08-01T16:45:00Z', label:'Out for delivery'}
        ]
      },
      {
        id:'RS-239872', date:'2025-07-18T09:05:00Z',
        items:[{name:'Wireless Mic Set', qty:1, price:850}],
        deliveryCharge:0, coupon:'', taxRate:0.18,
        ship:'14, MG Road\nBengaluru 560001', bill:'14, MG Road\nBengaluru 560001',
        status:'Delivered', eta:'Delivered on Jul 20',
        timeline:[
          {t:'2025-07-18T09:15:00Z', label:'Order confirmed'},
          {t:'2025-07-18T13:40:00Z', label:'Packed at warehouse'},
          {t:'2025-07-19T08:00:00Z', label:'Shipped'},
          {t:'2025-07-20T11:20:00Z', label:'Delivered'}
        ]
      },
      {
        id:'RS-239701', date:'2025-07-10T11:22:00Z',
        items:[{name:'Tripod Stand Pro', qty:1, price:300}],
        deliveryCharge:0, coupon:'', taxRate:0.18,
        ship:'14, MG Road\nBengaluru 560001', bill:'14, MG Road\nBengaluru 560001',
        status:'Cancelled', eta:'—',
        timeline:[
          {t:'2025-07-10T11:30:00Z', label:'Order cancelled'}
        ]
      }
    ];
    localStorage.setItem(key, JSON.stringify(seed));
  }
  let orders = JSON.parse(localStorage.getItem(key));

  // ---------- Current order ----------
  function setCurrent(){
    const cur = orders.find(o => ['Pending','Confirmed','Out for delivery'].includes(o.status));
    const curBox = $('#curSummary');
    if(!cur){ $('#curId').textContent='No active orders'; $('#curEta').textContent='—'; curBox.textContent='Your next order updates will appear here.'; $('#steps').innerHTML=''; $('#progress').style.width='0%'; return; }
    $('#curId').textContent = `${cur.id} • ${cur.status}`;
    $('#curEta').textContent = cur.eta || '—';

    const steps = ['Pending','Confirmed','Out for delivery','Delivered'];
    const idx = Math.max(0, steps.indexOf(steps.find(s=>cur.status.startsWith(s))));

    $('#steps').innerHTML = steps.map((s,i)=>`
      <li class="px-2 py-1 rounded-xl ${i<=idx?'bg-[var(--primary)] text-white':'bg-gray-100 text-gray-600'}">${s}</li>
    `).join('');
    $('#progress').style.width = ((idx+1)/steps.length*100)+'%';

    const count = cur.items.reduce((n,i)=>n+i.qty,0);
    const sub = cur.items.reduce((s,i)=>s+i.qty*i.price,0);
    curBox.textContent = `${count} item(s) • Subtotal ${fmt(sub)} • Delivery ${fmt(cur.deliveryCharge)} (coupon ${cur.coupon||'—'})`;
  }

  // ---------- Table rendering ----------
  const statusPill = (s)=>{
    if(s==='Pending') return '<span class="status-pill status-Pending">Pending</span>';
    if(s==='Confirmed') return '<span class="status-pill status-Confirmed">Confirmed</span>';
    if(s==='Out for delivery') return '<span class="status-pill status-Out">Out for delivery</span>';
    if(s==='Delivered') return '<span class="status-pill status-Delivered">Delivered</span>';
    return '<span class="status-pill status-Cancelled">Cancelled</span>';
  };

  function renderTable(){
    const q = $('#search').value.trim().toLowerCase();
    const f = $('#filter').value;
    const data = orders.filter(o=>{
      const matchesQ = !q || (o.id.toLowerCase().includes(q) || o.items.some(i=>i.name.toLowerCase().includes(q)));
      const matchesF = !f || o.status===f;
      return matchesQ && matchesF;
    });
    $('#count').textContent = data.length;

    const tb = $('#tbody'); tb.innerHTML='';
    data
      .slice() // copy
      .sort((a,b)=> new Date(b.date)-new Date(a.date))
      .forEach(o=>{
        const sub = o.items.reduce((s,i)=>s+i.price*i.qty,0);
        const disc = o.coupon==='SAVE10' ? Math.round(sub*0.10) : 0;
        const tax = Math.round((sub-disc)*o.taxRate);
        const total = sub - disc + tax + (o.deliveryCharge||0);

        const tr=document.createElement('tr');
        tr.className='bg-gray-50 hover:bg-gray-100';
        tr.innerHTML=`
          <td class="px-3 py-2 font-medium heading">${o.id}</td>
          <td class="px-3 py-2">${day(o.date)}</td>
          <td class="px-3 py-2 text-gray-700">${o.items.map(i=>`${i.name}×${i.qty}`).join(', ')}</td>
          <td class="px-3 py-2 text-right">${fmt(total)}</td>
          <td class="px-3 py-2">${statusPill(o.status)}</td>
          <td class="px-3 py-2"><button class="btn-primary px-3 py-1.5 text-sm" data-id="${o.id}">View</button></td>
        `;
        tb.appendChild(tr);
      });

    // wire view buttons
    $$('[data-id]').forEach(btn=>btn.addEventListener('click', ()=>openDrawer(btn.dataset.id)));
  }

  $('#search').addEventListener('input', renderTable);
  $('#filter').addEventListener('change', renderTable);
  $('#clearFilters').addEventListener('click', ()=>{ $('#search').value=''; $('#filter').value=''; renderTable(); });

  // ---------- Drawer ----------
  const drawer=$('#drawer');
  $('#dClose').addEventListener('click', ()=>drawer.classList.remove('open'));
  function openDrawer(id){
    const o = orders.find(x=>x.id===id); if(!o) return;
    $('#dId').textContent = `${o.id} • ${o.status}`;
    $('#dItems').innerHTML = o.items.map(i=>`
      <li class="flex justify-between"><span>${i.name} × ${i.qty}</span><span class="text-gray-700">${fmt(i.qty*i.price)}</span></li>
    `).join('');
    $('#dShip').textContent = o.ship || '—';
    $('#dBill').textContent = o.bill || '—';

    const sub = o.items.reduce((s,i)=>s+i.price*i.qty,0);
    const disc = o.coupon==='SAVE10' ? Math.round(sub*0.10) : 0;
    const tax = Math.round((sub-disc)*o.taxRate);
    const total = sub - disc + tax + (o.deliveryCharge||0);
    $('#dCharges').innerHTML = `
      <div>Subtotal: <b>${fmt(sub)}</b></div>
      <div>Discount: <b>${fmt(disc)}</b> ${o.coupon?`<span class="badge ml-1">${o.coupon}</span>`:''}</div>
      <div>Tax (18%): <b>${fmt(tax)}</b></div>
      <div>Delivery: <b>${fmt(o.deliveryCharge||0)}</b></div>
      <div class="mt-1 heading font-semibold">Total: ${fmt(total)}</div>
    `;

    $('#dTimeline').innerHTML = (o.timeline||[]).map(t=>`
      <li class="relative">
        <span class="absolute -left-2 top-1.5 h-3 w-3 rounded-full bg-[var(--primary)]"></span>
        <div class="text-xs text-gray-500">${new Date(t.t).toLocaleString()}</div>
        <div class="text-gray-800">${t.label}</div>
      </li>`).join('');

    drawer.classList.add('open');
  }

  // ---------- Init ----------
  setCurrent();
  renderTable();
</script>
</body>
</html>
